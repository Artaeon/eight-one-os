#!/usr/bin/env bash
# EIGHT.ONE OS â€” Clipboard Manager
# Wrapper around cliphist for clipboard history management

set -euo pipefail

GOLD='\e[33m'
CYAN='\e[36m'
RESET='\e[0m'

show_help() {
    echo -e "${GOLD}holy-clip${RESET} â€” Clipboard Manager"
    echo ""
    echo "Usage: holy-clip [command]"
    echo ""
    echo "Commands:"
    echo "  list     Browse clipboard history (fuzzel)"
    echo "  clear    Clear all clipboard history"
    echo "  wipe     Delete a specific entry"
    echo "  count    Show number of stored entries"
    echo ""
}

clip_list() {
    local selected
    selected="$(cliphist list | fuzzel --dmenu --prompt='ðŸ“‹ ' 2>/dev/null)" || return 0
    echo "$selected" | cliphist decode | wl-copy
    notify-send "ðŸ“‹ Clipboard" "Pasted from history"
}

clip_clear() {
    cliphist wipe
    notify-send "ðŸ“‹ Clipboard" "History cleared"
    echo -e "${GOLD}âœ“${RESET} Clipboard history cleared."
}

clip_wipe_entry() {
    local selected
    selected="$(cliphist list | fuzzel --dmenu --prompt='ðŸ—‘ Delete: ' 2>/dev/null)" || return 0
    echo "$selected" | cliphist delete
    notify-send "ðŸ“‹ Clipboard" "Entry removed"
}

clip_count() {
    local count
    count="$(cliphist list | wc -l)"
    echo -e "${CYAN}ðŸ“‹ Clipboard entries:${RESET} $count"
}

case "${1:-list}" in
    list)   clip_list ;;
    clear)  clip_clear ;;
    wipe)   clip_wipe_entry ;;
    count)  clip_count ;;
    *)      show_help ;;
esac
