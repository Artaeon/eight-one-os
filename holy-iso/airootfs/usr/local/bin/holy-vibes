#!/usr/bin/env bash

# EIGHT.ONE OS â€” Holy Vibes
# Background audio streams via mpv + yt-dlp
# Note: YouTube URLs may go offline over time. Update as needed.

echo "Invoking Holy Vibes..."

if ! command -v mpv &>/dev/null; then
    echo "Error: mpv is not installed."
    exit 1
fi

if ! command -v yt-dlp &>/dev/null; then
    echo "Error: yt-dlp is not installed (required for YouTube streams)."
    exit 1
fi

echo "Select your auditory environment:"
echo "1) Gregorian Chants (Monastic Ambient)"
echo "2) Christian Lofi Worship"
echo "3) Deep Focus Synthwave / Lofi"
echo "4) Stop current playback"
read -rp "Your choice (1/2/3/4): " choice

case $choice in
    1) url="https://www.youtube.com/watch?v=S2fF_T3fN48" ;;
    2) url="https://www.youtube.com/watch?v=R2m0yLwM1Lg" ;;
    3) url="https://www.youtube.com/watch?v=jfKfPfyJRdk" ;;
    4)
        pkill -f "mpv --no-video" 2>/dev/null && echo "Playback stopped." || echo "Nothing playing."
        exit 0
        ;;
    *)
        echo "Invalid choice."
        exit 1
        ;;
esac

# Kill existing vibes before starting new ones
pkill -f "mpv --no-video" 2>/dev/null

echo "Starting stream... (this may take a moment)"
if ! mpv --no-video --really-quiet "$url" &>/dev/null & then
    echo "Error: Failed to start playback. The stream may be unavailable."
    exit 1
fi
disown

echo "Vibes activated. Run 'holy-vibes' and choose 4 to stop."
